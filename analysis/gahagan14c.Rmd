---
title: "Temporal dynamics of Gahagan bifaces"
author: "Robert Z. Selden, Jr."
date: "October 27, 2019"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Loading the oxcAAR package

This document includes supplemental materials for paper: "Shape difference or shape change? Inter-regional variation in Gahagan biface morphology." Further information regarding the radiocarbon dates discussed below can be found in the text of the article.

```{r install}
if(!require('devtools')) install.packages('devtools')
library(devtools)
install_github('ISAAKiel/oxcAAR')
# load oxcAAR and OxCal
library(oxcAAR)
quickSetupOxcal()
```

## Calibration

### Calibration and plots for dates from Burial Pit 2 at the Gahagan Mound site

Three AMS dates (UGA12296, ISGS A0465, and ISGS A0466) were reported from Burial Pit 2 at the Gahagan Mound site. More information about these dates can be found in the text, and in those works cited in the text of the article.

```{r gahagancal, echo=TRUE}
gahagan<-data.frame(bp=c(1000,950,910),
                    std=c(40,40,35),
                    names=c("UGA-12296","ISGS-A0466","ISGS-A0465")
)
gahagancal<-oxcalCalibrate(gahagan$bp,gahagan$std,gahagan$names)
gahagancal
plot(gahagancal)
calcurve_plot(gahagancal)
```

### Calibration and plots for the dates from F119 and F134 at the George C. Davis site

Two dates (Tx-913 and Tx-1206) were reported from Features 119 and 134, respectively. More information about these dates can be found in the text, and in those works cited in the text of the article.

```{r GCDcal, echo=TRUE}
gcd<-data.frame(bp=c(1150,986),
                std=c(80,90),
                names=c("Tx-913","Tx-1206")
)
gcdcal<-oxcalCalibrate(gcd$bp,gcd$std,gcd$names)
gcdcal
plot(gcdcal)
calcurve_plot(gcdcal)
```

### Calibration and plots for dates from Burial Pit 5 at the Mounds Plantation site

Three dates (Tx-55, Tx-56, and M-1466) were reported from Burial Pit 5 at the Mounds Plantation site. More information about these dates can be found in the text, and in those works cited in the text of the article.

```{r mplcal, echo=TRUE}
moundspl<-data.frame(bp=c(860,900),
                     std=c(120,100),
                     names=c("Tx-55","M-1466")
)
moundsplcal<-oxcalCalibrate(moundspl$bp,moundspl$std,moundspl$names)
moundsplcal
plot(moundsplcal)
calcurve_plot(moundsplcal)
```

### Chronological model for Caddo contexts with Gahagan bifaces

For reasons explained in the text, Tx-1206 and Tx-56 are included in the model as outliers. The script that appears below achieves the same results in R and in OxCal. While Figure 3 in the article was produced using this script in OxCal 4.3.2 for aesthetic purposes, the chronological model was created using the oxcAAR package.

```{r chronmod, echo=TRUE}
knitr::opts_chunk$set(cache=TRUE)
bgahagan <- 'Plot()
{
  Phase()
  {
    Sequence("Gahagan Bifaces")
    {
      Boundary("start Gahagan Bifaces");
      Phase()
      {
        R_Date("Tx-1206", 475, 100)
        {
          Outlier();
        };
        R_Date("Tx-913", 1150, 80);
        R_Date("UGA-12296", 1000, 40);
        R_Date("ISGS-A0466", 950, 40);
        R_Date("ISGS-A0465", 910, 35);
        R_Combine("Log 1")
        {
          R_Date("Tx-55", 860, 120);
          R_Date("M-1466", 900, 100);
        };
        R_Date("Tx-56", 475, 100)
        {
          Outlier();
        };
      };
      Boundary("end Ghagan Bifaces");
    };
  };
};
'
  
  bgahagan_results <- executeOxcalScript(bgahagan) 
  bgahagan_text <- readOxcalOutput(bgahagan_results)
  bgahagan_result_data <- parseOxcalOutput(bgahagan_text, only.R_Date = F)
  str(bgahagan_result_data)
  print(bgahagan_result_data)
  plot(bgahagan_result_data)
  # end of script
```

### Acknowledgments

Thanks to Martin Hinz for fielding questions related to the oxcAAR package, and to Derek Hamilton for his guidance with the chronological model.
